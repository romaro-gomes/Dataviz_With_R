)
ggplot(data=dados2, aes(fill=name,x=Class,y=Percentage )) +
geom_bar(position="stack", stat="identity") +
coord_flip() +
scale_fill_viridis_d()+
labs(title ="Income and Expenditure of 150 Negro Families",
subtitle = "In Atlanta.GA,USA",
fill="Expendures",
caption= "Source: Dubois Challage\n GitHub:https://github.com/ajstarks/dubois-data-portraits/tree/master/challenge/2023/challenge01") +
theme(
plot.background = element_rect(fill="grey"),
plot.title = element_text(hjust=0.5),
plot.subtitle = element_text(hjust=0.5),
plot.caption=element_text(hjust =-0.2),
panel.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.text= element_text(colour = "black"),
legend.background = element_rect(fill='grey',color = 'grey'),
legend.position = 'bottom'
)
ggplot(data=dados2, aes(fill=name,x=Class,y=Percentage )) +
geom_bar(position="stack", stat="identity") +
coord_flip() +
scale_fill_viridis_d()+
labs(title ="Income and Expenditure of 150 Negro Families",
subtitle = "In Atlanta.GA,USA",
fill="Expendures",
caption= "Source: Dubois Challage GitHub:https://github.com/ajstarks/dubois-data-portraits/tree/master/challenge/2023/challenge01") +
theme(
plot.background = element_rect(fill="grey"),
plot.title = element_text(hjust=0.5),
plot.subtitle = element_text(hjust=0.5),
plot.caption=element_text(hjust =-0.2),
panel.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.text= element_text(colour = "black"),
legend.background = element_rect(fill='grey',color = 'grey'),
legend.position = 'bottom'
)
ggplot(data=dados2, aes(fill=name,x=Class,y=Percentage )) +
geom_bar(position="stack", stat="identity") +
coord_flip() +
scale_fill_viridis_d()+
labs(title ="Income and Expenditure of 150 Negro Families",
subtitle = "In Atlanta.GA,USA",
fill="Expendures",
caption= "Source: Dubois Challage / https://github.com/ajstarks/dubois-data-portraits/tree/master/challenge/2023/challenge01") +
theme(
plot.background = element_rect(fill="grey"),
plot.title = element_text(hjust=0.5),
plot.subtitle = element_text(hjust=0.5),
plot.caption=element_text(hjust =-0.2),
panel.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.text= element_text(colour = "black"),
legend.background = element_rect(fill='grey',color = 'grey'),
legend.position = 'bottom'
)
ggplot(data=dados2, aes(fill=name,x=Class,y=Percentage )) +
geom_bar(position="stack", stat="identity") +
coord_flip() +
scale_fill_viridis_d()+
labs(title ="Income and Expenditure of 150 Negro Families",
subtitle = "In Atlanta.GA,USA",
fill="Expendures",
caption= "Source: Dubois Visualization Challenge / https://github.com/ajstarks/dubois-data-portraits/tree/master/challenge/2023/challenge01") +
theme(
plot.background = element_rect(fill="grey"),
plot.title = element_text(hjust=0.5),
plot.subtitle = element_text(hjust=0.5),
plot.caption=element_text(hjust =-0.2),
panel.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.text= element_text(colour = "black"),
legend.background = element_rect(fill='grey',color = 'grey'),
legend.position = 'bottom'
)
ggplot(data=dados2, aes(fill=name,x=Class,y=Percentage )) +
geom_bar(position="stack", stat="identity") +
coord_flip() +
scale_fill_viridis_d()+
labs(title ="Income and Expenditure of 150 Negro Families",
subtitle = "In Atlanta.GA,USA",
fill="Expendures",
caption= "Source: Dubois Visualization Challenge / https://github.com/ajstarks/dubois-data-portraits/tree/master/challenge/2023/challenge01") +
theme(
plot.background = element_rect(fill="grey"),
plot.title = element_text(hjust=0.5),
plot.subtitle = element_text(hjust=0.5),
plot.caption=element_text(hjust =-0.4),
panel.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.text= element_text(colour = "black"),
legend.background = element_rect(fill='grey',color = 'grey'),
legend.position = 'bottom'
)
ggplot(data=dados2, aes(fill=name,x=Class,y=Percentage )) +
geom_bar(position="stack", stat="identity") +
coord_flip() +
scale_fill_viridis_d()+
labs(title ="Income and Expenditure of 150 Negro Families",
subtitle = "In Atlanta.GA,USA",
fill="Expendures",
caption= "Source: Dubois Visualization Challenge / https://github.com/ajstarks/dubois-data-portraits/tree/master/challenge/2023/challenge01") +
theme(
plot.background = element_rect(fill="grey"),
plot.title = element_text(hjust=0.5),
plot.subtitle = element_text(hjust=0.5),
plot.caption=element_text(hjust =-0.4, size= 10),
panel.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.text= element_text(colour = "black"),
legend.background = element_rect(fill='grey',color = 'grey'),
legend.position = 'bottom'
)
ggplot(data=dados2, aes(fill=name,x=Class,y=Percentage )) +
geom_bar(position="stack", stat="identity") +
coord_flip() +
scale_fill_viridis_d()+
labs(title ="Income and Expenditure of 150 Negro Families",
subtitle = "In Atlanta.GA,USA",
fill="Expendures",
caption= "Source: Dubois Visualization Challenge / https://github.com/ajstarks/dubois-data-portraits/tree/master/challenge/2023/challenge01") +
theme(
plot.background = element_rect(fill="grey"),
plot.title = element_text(hjust=0.5),
plot.subtitle = element_text(hjust=0.5),
plot.caption=element_text(hjust =-0.4, size= 3),
panel.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.text= element_text(colour = "black"),
legend.background = element_rect(fill='grey',color = 'grey'),
legend.position = 'bottom'
)
ggplot(data=dados2, aes(fill=name,x=Class,y=Percentage )) +
geom_bar(position="stack", stat="identity") +
coord_flip() +
scale_fill_viridis_d()+
labs(title ="Income and Expenditure of 150 Negro Families",
subtitle = "In Atlanta.GA,USA",
fill="Expendures",
caption= "Source: Dubois Visualization Challenge / https://github.com/ajstarks/dubois-data-portraits/tree/master/challenge/2023/challenge01") +
theme(
plot.background = element_rect(fill="grey"),
plot.title = element_text(hjust=0.5),
plot.subtitle = element_text(hjust=0.5),
plot.caption=element_text(hjust =-0.4, size= 5),
panel.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.text= element_text(colour = "black"),
legend.background = element_rect(fill='grey',color = 'grey'),
legend.position = 'bottom'
)
ggplot(data=dados2, aes(fill=name,x=Class,y=Percentage )) +
geom_bar(position="stack", stat="identity") +
coord_flip() +
scale_fill_viridis_d()+
labs(title ="Income and Expenditure of 150 Negro Families",
subtitle = "In Atlanta.GA,USA",
fill="Expendures",
caption= "Source: Dubois Visualization Challenge / https://github.com/ajstarks/dubois-data-portraits/tree/master/challenge/2023/challenge01") +
theme(
plot.background = element_rect(fill="grey"),
plot.title = element_text(hjust=0.5),
plot.subtitle = element_text(hjust=0.5),
plot.caption=element_text(hjust =-0.4, size= 6),
panel.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.text= element_text(colour = "black"),
legend.background = element_rect(fill='grey',color = 'grey'),
legend.position = 'bottom'
)
ggplot(data=dados2, aes(fill=name,x=Class,y=Percentage )) +
geom_bar(position="stack", stat="identity") +
coord_flip() +
scale_fill_viridis_d()+
labs(title ="Income and Expenditure of 150 Negro Families",
subtitle = "In Atlanta.GA,USA",
fill="Expendures",
caption= "Source: Dubois Visualization Challenge / https://github.com/ajstarks/dubois-data-portraits/tree/master/challenge/2023/challenge01") +
theme(
plot.background = element_rect(fill="grey"),
plot.title = element_text(hjust=0.5),
plot.subtitle = element_text(hjust=0.5),
plot.caption=element_text(hjust =-0.4, size= 7),
panel.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.text= element_text(colour = "black"),
legend.background = element_rect(fill='grey',color = 'grey'),
legend.position = 'bottom'
)
ggplot(data=dados2, aes(fill=name,x=Class,y=Percentage )) +
geom_bar(position="stack", stat="identity") +
coord_flip() +
scale_fill_viridis_d()+
labs(title ="Income and Expenditure of 150 Negro Families",
subtitle = "In Atlanta.GA,USA",
fill="Expendures",
caption= "Source: Dubois Visualization Challenge / https://github.com/ajstarks/dubois-data-portraits/tree/master/challenge/2023/challenge01") +
theme(
plot.background = element_rect(fill="grey"),
plot.title = element_text(hjust=0.5),
plot.subtitle = element_text(hjust=0.5),
plot.caption=element_text(hjust =-0.4, size= 6),
panel.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.text= element_text(colour = "black"),
legend.background = element_rect(fill='grey',color = 'grey'),
legend.position = 'bottom'
)
ggplot(data=dados2, aes(fill=name,x=Class,y=Percentage )) +
geom_bar(position="stack", stat="identity") +
coord_flip() +
scale_fill_viridis_d()+
labs(title ="Income and Expenditure of 150 Negro Families",
subtitle = "In Atlanta.GA,USA",
fill="Expendures",
caption= "Source: Dubois Visualization Challenge / https://github.com/ajstarks/dubois-data-portraits/tree/master/challenge/2023/challenge01") +
theme(
plot.background = element_rect(fill="grey"),
plot.title = element_text(hjust=0.5),
plot.subtitle = element_text(hjust=0.5),
plot.caption=element_text(hjust =-0.5, size= 6),
panel.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.text= element_text(colour = "black"),
legend.background = element_rect(fill='grey',color = 'grey'),
legend.position = 'bottom'
)
ggplot(data=dados2, aes(fill=name,x=Class,y=Percentage )) +
geom_bar(position="stack", stat="identity") +
coord_flip() +
scale_fill_viridis_d()+
labs(title ="Income and Expenditure of 150 Negro Families",
subtitle = "In Atlanta.GA,USA",
fill="Expendures",
caption= "Source: Dubois Visualization Challenge / https://github.com/ajstarks/dubois-data-portraits/tree/master/challenge/2023/challenge01") +
theme(
plot.background = element_rect(fill="grey"),
plot.title = element_text(hjust=0.5),
plot.subtitle = element_text(hjust=0.5),
plot.caption=element_text(hjust =-0.8, size= 6),
panel.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.text= element_text(colour = "black"),
legend.background = element_rect(fill='grey',color = 'grey'),
legend.position = 'bottom'
)
ggplot(data=dados2, aes(fill=name,x=Class,y=Percentage )) +
geom_bar(position="stack", stat="identity") +
coord_flip() +
scale_fill_viridis_d()+
labs(title ="Income and Expenditure of 150 Negro Families",
subtitle = "In Atlanta.GA,USA",
fill="Expendures",
caption= "Source: Dubois Visualization Challenge / https://github.com/ajstarks/dubois-data-portraits/tree/master/challenge/2023/challenge01") +
theme(
plot.background = element_rect(fill="grey"),
plot.title = element_text(hjust=0.5),
plot.subtitle = element_text(hjust=0.5),
plot.caption=element_text(hjust =-0.8, size= 6.5),
panel.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.text= element_text(colour = "black"),
legend.background = element_rect(fill='grey',color = 'grey'),
legend.position = 'bottom'
)
ggplot(data=dados2, aes(fill=name,x=Class,y=Percentage )) +
geom_bar(position="stack", stat="identity") +
coord_flip() +
scale_fill_viridis_d()+
labs(title ="Income and Expenditure of 150 Negro Families",
subtitle = "In Atlanta.GA,USA",
fill="Expendures",
caption= "Source: Dubois Visualization Challenge / https://github.com/ajstarks/dubois-data-portraits/tree/master/challenge/2023/challenge01") +
theme(
plot.background = element_rect(fill="grey"),
plot.title = element_text(hjust=0.5),
plot.subtitle = element_text(hjust=0.5),
plot.caption=element_text(hjust =-0.1, size= 6.5),
panel.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.text= element_text(colour = "black"),
legend.background = element_rect(fill='grey',color = 'grey'),
legend.position = 'bottom'
)
ggplot(data=dados2, aes(fill=name,x=Class,y=Percentage )) +
geom_bar(position="stack", stat="identity") +
coord_flip() +
scale_fill_viridis_d()+
labs(title ="Income and Expenditure of 150 Negro Families",
subtitle = "In Atlanta.GA,USA",
fill="Expendures",
caption= "Source: Dubois Visualization Challenge / https://github.com/ajstarks/dubois-data-portraits/tree/master/challenge/2023/challenge01") +
theme(
plot.background = element_rect(fill="grey"),
plot.title = element_text(hjust=0.5),
plot.subtitle = element_text(hjust=0.5),
plot.caption=element_text(hjust =-0.10, size= 6.5),
panel.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.text= element_text(colour = "black"),
legend.background = element_rect(fill='grey',color = 'grey'),
legend.position = 'bottom'
)
ggplot(data=dados2, aes(fill=name,x=Class,y=Percentage )) +
geom_bar(position="stack", stat="identity") +
coord_flip() +
scale_fill_viridis_d()+
labs(title ="Income and Expenditure of 150 Negro Families",
subtitle = "In Atlanta.GA,USA",
fill="Expendures",
caption= "Source: Dubois Visualization Challenge / https://github.com/ajstarks/dubois-data-portraits/tree/master/challenge/2023/challenge01") +
theme(
plot.background = element_rect(fill="grey"),
plot.title = element_text(hjust=0.5),
plot.subtitle = element_text(hjust=0.5),
plot.caption=element_text(hjust =-1, size= 6.5),
panel.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.text= element_text(colour = "black"),
legend.background = element_rect(fill='grey',color = 'grey'),
legend.position = 'bottom'
)
ggplot(data=dados2, aes(fill=name,x=Class,y=Percentage )) +
geom_bar(position="stack", stat="identity") +
coord_flip() +
scale_fill_viridis_d()+
labs(title ="Income and Expenditure of 150 Negro Families",
subtitle = "In Atlanta.GA,USA",
fill="Expendures",
caption= "Source: Dubois Visualization Challenge / https://github.com/ajstarks/dubois-data-portraits/tree/master/challenge/2023/challenge01") +
theme(
plot.background = element_rect(fill="grey"),
plot.title = element_text(hjust=0.5),
plot.subtitle = element_text(hjust=0.5),
plot.caption=element_text(hjust =-1.2, size= 6.5),
panel.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.text= element_text(colour = "black"),
legend.background = element_rect(fill='grey',color = 'grey'),
legend.position = 'bottom'
)
ggsave(path =here(),file="c01_2023.png")
library(modeldata)
car_prices=modeldata::car_prices
library(here)
library(tidymodels)
car_prices |> head()
car_prices_fif=glm(Prices ~ ., data=car_prices)
car_prices |> head()
car_prices_fif=glm(Price ~ ., data=car_prices)
car_prices_fit=glm(Price ~ ., data=car_prices)
plot(car_prices_fit)
summary(car_prices_fit)
corrplot::corrplot(car_prices)
corrplot::corrplot(cor(car_prices))
dim(car_prices)
car_split = initial_split(car_prices,prop = 0.80)
car_split
car_training = training(car_split)
car_test = testing(car_split)
library(modeldata)
library(here)
library(tidymodels)
car_prices=modeldata::car_prices
summary(car_prices_fit)
corrplot::corrplot(cor(car_prices))
ggplot(car_prices, aes(x = Sale_Price)) +
geom_histogram(bins = 50, col= "white")
ggplot(car_prices, aes(x = Price)) +
geom_histogram(bins = 50, col= "white")
car_prices = car_prices |> mutate(Price= log10(Price))
car_prices = car_prices |> mutate(Price= log10(Price))
ggplot(car_prices, aes(x = Price)) +
geom_histogram(bins = 50, col= "white")
#----------------------------------------------------
set.seed(123)
lm_model =
linear_reg() %>%
set_engine("lm")
(123)
# Split Model----------------------------------------------------
set.seed(123)
car_split = initial_split(car_prices,prop = 0.80)
car_training = training(car_split)
car_test = testing(car_split)
lm_model =
linear_reg() %>%
set_engine("lm")
lm_form_fit <-
lm_model |>
fit(Price ~ ., data = car_train)
lm_form_fit <-
lm_model |>
fit(Price ~ ., data = car_training)
lm_xy_fit <-
lm_model %>%
fit_xy(
x = ames_train %>% select(!Price),
y = ames_train %>% pull(Price)
)
lm_xy_fit <-
lm_model %>%
fit_xy(
x = car_training %>% select(!Price),
y = car_training %>% pull(Price)
)
lm_form_fit %>% extract_fit_engine()
car_prices |> is.na()  |> sum()
summary(car_prices)
car_prices$wagon
car_prices$sedan
car_prices |> head()
car_prices |> head(method="person")
car_prices |> head(method="person")
car_prices=modeldata::car_prices
car_prices = car_prices |> mutate(Price= log10(Price))
# Split Model----------------------------------------------------
set.seed(123)
car_split = initial_split(car_prices,prop = 0.80)
car_split
# Correlation -----------------------------------------------------------
corrplot::corrplot(cor(car_prices))
# Correlation -----------------------------------------------------------
corrplot::corrplot(cor(car_prices))
library(caret)
car_split = car_prices |> select(Price, Mileage, Cylinder, Doors)
# Split Model----------------------------------------------------
set.seed(123)
car_split = initial_split(car_split,prop = 0.80)
car_split
car_training = training(car_split)
car_test = testing(car_split)
lm_model =
linear_reg() %>%
set_engine("lm")
lm_form_fit <-
lm_model |>
fit(Price ~ ., data = car_training)
lm_xy_fit <-
lm_model %>%
fit_xy(
x = car_training %>% select(!Price),
y = car_training %>% pull(Price)
)
# Extract information for model -------------------------------
lm_form_fit %>% extract_fit_engine()
lm_form_fit %>% extract_fit_engine() %>% vcov()
model_res <-
lm_form_fit %>%
extract_fit_engine() %>%
summary()
model_res
param_est <- coef(model_res)
param_est
lm_form_fit %>% extract_fit_engine() %>% vcov()
tidy(lm_form_fit)
# Predictions ---------------------------------
car_test_small <- car_test %>% slice(1:5)
car_test_small
source("D:/Romario/Programar/Ferramentas/R/Projetos/Dataviz/Car_prices/script.R", echo=TRUE)
source("D:/Romario/Programar/Ferramentas/R/Projetos/Dataviz/Car_prices/script.R", echo=TRUE)
predict(lm_form_fit, new_data = car_test_small)
car_test_small %>%
select(Price) %>%
bind_cols(predict(lm_form_fit, car_test_small))
car_test_small %>%
select(Price) %>%
bind_cols(predict(lm_form_fit, car_test_small, type="pred_int"))
car_test_small %>%
select(Price) %>%
bind_cols(predict(lm_form_fit, car_test_small, type="pred_int")) %>%
bind_cols(predict(lm_form_fit, car_test_small))
car_test_small %>%
select(Price) %>%
bind_cols(predict(lm_form_fit, car_test_small, type="conf_int")) %>%
bind_cols(predict(lm_form_fit, car_test_small))
tree_model <-
decision_tree(min_n = 2) %>%
set_engine("rpart") %>%
set_mode("regression")
tree_fit <-
tree_model %>%
fit(Price ~ ., data = car_training)
car_test_small %>%
select(Price) %>%
bind_cols(predict(tree_fit, car_test_small))
car_test_small %>%
select(Price) %>%
bind_cols(predict(lm_form_fit, car_test_small, type="pred_int")) %>%
bind_cols(predict(lm_form_fit, car_test_small))
#Select model ---------------------------------------
parsnip_addin()
